"use client";

import AuthHeader from "@/component/static/auth/header/header";
import AuthSideMenu from "@/component/static/auth/side/menu";
import { useSession } from "next-auth/react";
import { redirect } from "next/navigation";
import { useEffect, useState } from "react";

export const metadata = {
  title: "Next.js",
  description: "Generated by Next.js",
};

const AuthLayout = ({ children }) => {
  const { data: session } = useSession();
  const [minHeight, setMinHeight] = useState("0");

  const fixMainHeight = () => {
    const headerHeight = document.querySelector("header").clientHeight;
    const footerHeight = document.querySelector("footer").clientHeight;

    setMinHeight(headerHeight + footerHeight);
  };

  useEffect(() => {
    fixMainHeight();
    window.addEventListener("resize", fixMainHeight);
  });

  if (!session) {
    return redirect("/ingreso");
  }

  return (
    <>
      <div className="flex">
        <AuthSideMenu />
        <div className="relative w-full">
          <header className="sticky top-0">
            <AuthHeader />
          </header>
          <main style={{ minHeight: `calc(100vh - ${minHeight}px)` }}>
            {children}
          </main>
          <footer>Footer</footer>
        </div>
      </div>
    </>
  );
};

export default AuthLayout;
